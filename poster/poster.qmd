---
title: Visualizing Billion-Dollar Disasters in the USA (1980--2024)
format:
  poster-typst: 
    size: "33x23" # Approximately A1
    poster-authors: "Oh Jia Wei Darien, Peter Febrianto Afandy, Quek Joo Wee, Desmond Loy Yong Kiat,\n\nRene Low Yi Xuan, Phileo Teo Weihan"
    departments: "SIT-UoG Computing Science"
    institution-logo: "images/sit-logo.png"
    footer-text: "CSC3107 Project"
    footer-emails: "2200607@sit.singaporetech.edu.sg, 2200959@sit.singaporetech.edu.sg, 2201046@sit.singaporetech.edu.sg, 2201435@sit.singaporetech.edu.sg, 2202620@sit.singaporetech.edu.sg, 2203179@sit.singaporetech.edu.sg"
execute:
  echo: false
knitr:
  opts_chunk:
    dev: svglite
---

```{r}
#| label: setup
#| include: false

# Execute data preparations and load graphics
library(knitr)
library(scales)
library(ggplot2)
library(dplyr)
library(patchwork)
purl("preparation.qmd")
source("preparation.R")

# Define custom colors for each category, based on the Paired color palette
category_colors <- c(
  "All Events" = "#6A3D9A",
  "Dry Weather Events" = "#FF7F00",
  "Storm Events" = "#33A02C",
  "Wet Weather Events" = "#1F78B4"
)
legend_colors <- c("#6A3D9A", "#33A02C", "#FF7F00", "#1F78B4")
```

# Introduction

\<some intro and info on disaster relief fund being drained..\>

To highlight the need for enhanced disaster preparedness in the USA, Dottle and Kaufman[^1] presented a combined plot visualizing the total estimated costs by disaster type and the frequency of such events from 1980 to 2023. The plot demonstrated the increased frequency of various types of disasters over the years, likely driven by factors such as climate change, along with their escalating financial impact and costs. Coupled with the depletion of the country's Disaster Relief Fund (DRF), this elucidates the dire need for proactive preparations and mitigations to address the growing threat of such disasters effectively.

[^1]: Dottle, R., & Kaufman, L. (2023). Climate Disasters Drain US Emergency Fund, Adding to Government Shutdown Risk. Retrieved from https://www.bloomberg.com/graphics/2023-fema-disaster-relief-fund-extreme-weather-climate-aid/

# Previous Visualization

```{r}
#| label: fig-bb-on-poster
#| fig-cap: "Frequency and Estimated Costs of Billion-Dollar Disasters in the
#| USA by year, published by Bloomberg."
#| out-width: 100%

include_graphics("images/bb_bdd_cropped.png")
```

# Strengths

-   The graph includes a *dual-axis* representation of the frequency and costs of billion-dollar disasters, providing a comprehensive overview of the data with the use of stacked areas and bars.
-   It includes *annotated descriptions* on certain data points, enhancing the interpretability of the visualisation.
-   The timeline shows *clear trends* over the decades, highlighting the increasing frequency and costs of natural disasters.

# Suggested Improvements

1.  *Split the visualisation into two separate plots* to better highlight the trends in frequency and costs of billion-dollar disasters.
2.  *Enhance the color palette* to improve readability and distinguish between different disaster types.
3.  *Group disaster types* together to provide a clearer overview of the data.

# Implementation

## Data

-   ...
-   ...

## Software

We used the Quarto publication framework and the R programming language, along with the following third-party packages:

-   *tidyverse* for data transformation, including *ggplot2* for visualization based on the grammar of graphics
-   *knitr* for dynamic document generation

# Improved Visualization

## Estimated Costs of Billion-Dollar Disasters in the USA by Year

```{r}
#| label: fig-ggplot
#| fig-width: 10
#| fig-height: 8
#| fig-cap: "Revised visualization of Estimated Costs of Billion-Dollar
#| Disasters in the USA by year."
#| warning: false

# Plot the estimated costs of billion-dollar disasters in the USA by year
bdd_cost_plot <- ggplot(bdd_cost_combined) +
  aes(
    x = Interval,
    y = Cost,
    color = Category,
    group = Category,
    linetype = Category
  ) +
  # Plot colored area under the overall trend line
  stat_smooth(
    data = bdd_cost_summary_aggregated,
    aes(fill = Category),
    geom = "area",
    span = 0.45,
    alpha = 0.05,
    linewidth = 0
  ) +
  stat_smooth(method = "loess", span = 0.5) +
  geom_point(size = 3) +
  labs(
    x = "Year",
    y = expression("Estimated Cost (Billion $USD)"^1 * ""),
    color = "Disaster Type",
    title = paste(
      "Frequency and Estimated Costs of Billion-Dollar",
      "Disasters in the USA (1980-2024)"
    )
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
    legend.title = element_text(size = 11.5, margin = margin(r = 10)),
    legend.text = element_text(size = 11.5),
    legend.position = "top",
    axis.title = element_text(size = 14),
    axis.title.x = element_text(
      size = 14,
      hjust = 1.07,
      margin = margin(t = -13)
    ),
    axis.title.y = element_text(margin = margin(r = 20)),
    axis.text = element_text(size = 12),
    panel.grid.minor = element_blank(),
    plot.margin = unit(c(0, 1.5, 0, 0), "cm")
  ) +
  scale_color_manual(values = category_colors) +
  scale_fill_manual(values = category_colors) +
  scale_linetype_manual(
    values = c(
      "All Events" = "dashed", "Dry Weather Events" = "solid",
      "Storm Events" = "solid", "Wet Weather Events" = "solid"
    )
  ) +
  scale_y_continuous(
    breaks = seq(0, max(bdd_cost_summary_aggregated$Cost) + 50, by = 50)
  ) +
  guides(
    shape = "none",
    fill = "none",
    linetype = "none",
    color = guide_legend(override.aes = list(
      fill = legend_colors,
      color = NA,
      size = 2,
      alpha = 1
    ))
  )
bdd_cost_plot
```

## Frequency of Billion-Dollar Disasters in the USA by Year

```{r}
#| label: fig-ggplot2
#| fig-width: 10
#| fig-height: 8
#| fig-cap: "Revised Visualisation of Frequency of Billion-Dollar Disasters
#| in the USA by year."
#| warning: false

# Main plot for combined with year interval
bdd_freq_plot <- ggplot() +
  geom_bar(
    data = bdd_frequency_summary,
    aes(x = Interval, y = Count, fill = Category, group = Category),
    stat = "identity", width = 0.55
  ) +
  geom_smooth(
    data = bdd_frequency_total,
    aes(x = Interval, y = TotalCount, group = 1),
    color = "#6A3D9A",
    linetype = "dashed",
    size = 1.1,
    span = 0.7,
    se = FALSE
  ) +
  labs(
    y = "Frequency",
    caption = "Source: NCEI (2024)\n\nÂ¹CPI-adjusted for inflation"
  ) +
  theme_minimal() +
  theme(
    plot.caption = element_text(size = 12, margin = margin(t = 10)),
    legend.title = element_text(size = 12, margin = margin(r = 12)),
    legend.text = element_text(size = 10),
    legend.position = "top",
    axis.title = element_text(size = 14),
    axis.title.x = element_blank(),
    axis.title.y = element_text(margin = margin(r = 20)),
    axis.text = element_text(size = 12),
    axis.text.x = element_blank(),
    panel.grid.minor = element_blank()
  ) +
  guides(
    fill = guide_legend(
      title = "Disaster",
      title.position = "left",
      label.position = "right",
      keywidth = unit(1, "lines"),
      keyheight = unit(1, "lines")
    )
  ) +
  scale_fill_manual(values = category_colors) +
  scale_y_reverse(breaks = seq(0, 100, by = 10), limits = c(100, 0)) +
  guides(fill = FALSE)
bdd_freq_plot
```

## Combined Plot of Costs and Frequency

```{r}
#| label: fig-combined-plot
#| fig-width: 10
#| fig-height: 10
#| fig-cap: "Revised Visualisation of Frequency and Estimated Costs of
#| Billion-Dollar Disasters in the USA by year."
#| warning: false

combined_plots <- bdd_cost_plot / bdd_freq_plot
combined_plots
```

# Further Suggestions for Interactivity

...

# Conclusion

...
